<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Frequentist threshold-based inference for return levels — returnLevel • lite</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Frequentist threshold-based inference for return levels — returnLevel"><meta property="og:description" content="Calculates point estimates and confidence intervals for m-year
return levels for stationary time series fitted extreme value model objects
returned from flite.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the maximum
likelihood estimator for return level, which are symmetric about the point
estimate, and (b) profile likelihood-based intervals based on an (adjusted)
log-likelihood."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lite</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction-to-lite.html">Introducing lite: Likelihood-Based Inference for Time Series Extremes</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/paulnorthrop/lite/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Frequentist threshold-based inference for return levels</h1>
    <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/lite/blob/HEAD/R/returnLevel.R" class="external-link"><code>R/returnLevel.R</code></a></small>
    <div class="hidden name"><code>returnLevel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates point estimates and confidence intervals for <code>m</code>-year
return levels for stationary time series fitted extreme value model objects
returned from <code><a href="flite.html">flite</a></code>.  Two types of interval may be returned:
(a) intervals based on approximate large-sample normality of the maximum
likelihood estimator for return level, which are symmetric about the point
estimate, and (b) profile likelihood-based intervals based on an (adjusted)
log-likelihood.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">returnLevel</span><span class="op">(</span>
  <span class="va">x</span>,
  m <span class="op">=</span> <span class="fl">100</span>,
  level <span class="op">=</span> <span class="fl">0.95</span>,
  <span class="va">ny</span>,
  prof <span class="op">=</span> <span class="cn">TRUE</span>,
  inc <span class="op">=</span> <span class="cn">NULL</span>,
  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vertical"</span>, <span class="st">"cholesky"</span>, <span class="st">"spectral"</span>, <span class="st">"none"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>An object inheriting from class <code>"flite"</code> returned from
<code><a href="flite.html">flite</a></code>.</p></dd>
<dt>m</dt>
<dd><p>A numeric scalar.  The return period, in years.</p></dd>
<dt>level</dt>
<dd><p>A numeric scalar in (0, 1).  The confidence level required for
confidence interval for the <code>m</code>-year return level.</p></dd>
<dt>ny</dt>
<dd><p>A numeric scalar.  The (mean) number of observations per year.
<strong>Setting this appropriately is important</strong>. See <strong>Details</strong>.</p></dd>
<dt>prof</dt>
<dd><p>A logical scalar.  Should we calculate intervals based on
profile log-likelihood?</p></dd>
<dt>inc</dt>
<dd><p>A numeric scalar. Only relevant if <code>prof = TRUE</code>. The
increment in return level by which we move upwards and downwards from the
MLE for the return level in the search for the lower and upper confidence
limits.  If this is not supplied then <code>inc</code> is set to one hundredth
of the length of the symmetric confidence interval for return level.</p></dd>
<dt>type</dt>
<dd><p>A character scalar.  The argument <code>type</code> to the function
returned by the function <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>, that is, the type of
adjustment made to the independence log-likelihood function in creating
an adjusted log-likelihood function.  See <strong>Details</strong> and
<strong>Value</strong> in <code><a href="https://paulnorthrop.github.io/chandwich/reference/adjust_loglik.html" class="external-link">adjust_loglik</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A object (a list) of class <code>"returnLevel", "lite"</code> with the
  components</p>
<dl><dt>rl_sym,rl_prof </dt>
<dd><p>Named numeric vectors containing the respective
    lower 100<code>level</code>% limit, the MLE and the upper
    100<code>level</code>% limit for the return level.
    If <code>prof = FALSE</code> then <code>rl_prof</code> will be missing.</p></dd>
<dt>rl_se </dt>
<dd><p>Estimated standard error of the return level.</p></dd>
<dt>max_loglik,crit,for_plot </dt>
<dd><p>If <code>prof = TRUE</code> then
    these components will be present, containing respectively: the maximised
    log-likelihood; the critical value and a matrix with return levels in
    the first column (<code>ret_levs</code>) and the corresponding values of the
    (adjusted) profile log-likelihood (<code>prof_loglik</code>).</p></dd>
<dt>m,level </dt>
<dd><p>The input values of <code>m</code> and <code>level</code>.</p></dd>
<dt>ny </dt>
<dd><p>The value of <code>ny</code> used to infer the return level.</p></dd>
<dt>call </dt>
<dd><p>The call to <code>returnLevel</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>For information about return levels see the "Introducing lite"
  vignette.</p>
<p><code>ny</code> provides information about the (intended) frequency of
  sampling in time, that is, the number of observations that would be
  observed in a year if there are no missing values.  If the number of
  observations may vary between years then <code>ny</code> should be set equal to
  the mean number of observations per year.</p>
<p><strong>Supplying <code>ny</code>.</strong>
  The value of <code>ny</code> may have been set in the call to
  <code><a href="flite.html">flite</a></code>.  If <code>ny</code> is supplied by the user in the call to
  <code>returnLevel</code> then this will be used in preference to the value
  stored in the fitted model object.  If these two values differ then no
  warning will be given.</p>
<p>For details of the definition and estimation of return levels see the
  Inference for return levels vignette.</p>
<p>The profile likelihood-based intervals are calculated by
  reparameterising in terms of the <code>m</code>-year return level and estimating
  the values at which the (adjusted) profile log-likelihood reaches
  the critical value <code>logLik(x) - 0.5 * stats::qchisq(level, 1)</code>.
  This is achieved by calculating the profile log-likelihood for a sequence
  of values of this return level as governed by <code>inc</code>. Once the profile
  log-likelihood drops below the critical value the lower and upper limits are
  estimated by interpolating linearly between the cases lying either side of
  the critical value. The smaller <code>inc</code> the more accurate (but slower)
  the calculation will be.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Coles, S. G. (2001) <em>An Introduction to Statistical
  Modeling of Extreme Values</em>, Springer-Verlag, London.
  doi: <a href="https://doi.org/10.1007/978-1-4471-3675-0_3" class="external-link">10.1007/978-1-4471-3675-0_3</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="returnLevelMethods.html">returnLevelMethods</a></code>, including plotting the (adjusted)
  profile log-likelihood for a return level.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">### Cheeseboro wind gusts</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Make inferences</span></span>
<span class="r-in"><span class="va">cdata</span> <span class="op">&lt;-</span> <span class="fu">exdex</span><span class="fu">::</span><span class="va"><a href="https://paulnorthrop.github.io/exdex/reference/cheeseboro.html" class="external-link">cheeseboro</a></span></span>
<span class="r-in"><span class="co"># Each column of the matrix cdata corresponds to data from a different year</span></span>
<span class="r-in"><span class="co"># flite() sets cluster automatically to correspond to column (year)</span></span>
<span class="r-in"><span class="va">cfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="flite.html">flite</a></span><span class="op">(</span><span class="va">cdata</span>, u <span class="op">=</span> <span class="fl">45</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># These data are hourly for one month (January) year so ny = 31 * 24</span></span>
<span class="r-in"><span class="co"># Large inc set here for speed, sacrificing accuracy</span></span>
<span class="r-in"><span class="co"># Default 95% confidence intervals</span></span>
<span class="r-in"><span class="va">rl</span> <span class="op">&lt;-</span> <span class="fu">returnLevel</span><span class="op">(</span><span class="va">cfit</span>, inc <span class="op">=</span> <span class="fl">2.5</span>, ny <span class="op">=</span> <span class="fl">31</span> <span class="op">*</span> <span class="fl">24</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> returnLevel(x = cfit, ny = 31 * 24, inc = 2.5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m = 100 90.72766   10.39134</span>
<span class="r-in"><span class="va">rl</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> returnLevel(x = cfit, ny = 31 * 24, inc = 2.5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MLE and 95% confidence limits for the 100-year return level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Normal interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lower     mle   upper  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  70.36   90.73  111.09  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Profile likelihood-based interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lower     mle   upper  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  77.41   90.73  132.59  </span>
<span class="r-in"><span class="va">oldrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rl</span><span class="op">)</span></span>
<span class="r-plt img"><img src="returnLevel-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">oldrl</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower       mle     upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  77.40789  90.72766 132.59250 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Quickly recalculate/replot the intervals based on profile log-likelihood</span></span>
<span class="r-in"><span class="co"># provided that level is smaller than that used to produce rl</span></span>
<span class="r-in"><span class="va">newrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rl</span>, level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span class="r-plt img"><img src="returnLevel-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">newrl</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower       mle     upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  78.93789  90.72766 120.95866 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

